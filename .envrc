# .envrc file: Configures the environment when you cd into the directory

#set -x

use flake 

# Ensures Python doesn't demand a virtualenv check for system-wide installs
export PIP_REQUIRE_VIRTUALENV=false

# Create/manage the local .venv for Python packages using the Nix-built uv
if [ ! -d .venv ]; then
  $(which uv) venv .venv
fi

# Sync requirements into the .venv using the Nix-built uv binary
$(which uv) sync

# Install/Clean pre-commit hooks using the Nix-built pre-commit binary
$(which pre-commit) install-hooks
$(which pre-commit) clean

# Activate the local venv (sets PYTHONPATH and PATH correctly for Python libs)
source .venv/bin/activate

# Alias 'python' to the venv-specific python binary
alias python="python3"
