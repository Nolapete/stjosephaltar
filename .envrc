# .envrc file: Configures the environment when you cd into the directory

set -x

use nix # Tells direnv to use the nix shell environment first

# These commands run *inside* the Nix environment:
export PIP_REQUIRE_VIRTUALENV=false

# Create/manage the local .venv for Python packages
if [ ! -d .venv ]; then
  echo "Creating .venv using uv..."
  uv venv .venv
fi

# Activate the local venv (sets PYTHONPATH and PATH correctly)
source .venv/bin/activate

# Sync requirements from pyproject.toml/requirements.txt into the .venv
uv sync

# Install pre-commit hooks
pre-commit install-hooks

pre-commit clean

# --- CRITICAL FIX ---
# Alias 'python' to the venv-specific python binary
alias python="python3" 
